---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import { robes } from "../../data/robes";

export async function getStaticPaths() {
  return robes.map((robe) => ({
    params: { id: robe.id.toString() },
  }));
}

const { id } = Astro.params;
const robeId = parseInt(id || "0");
const robe = robes.find((r) => r.id === robeId);

if (!robe) {
  return Astro.redirect("/robes");
}
---

<BaseLayout title={robe.name} description={robe.description}>
  <Header />

      <main class="pt-24 md:pt-20">
    <section class="section bg-white">
      <div class="container">
        <a
          href="/robes"
          class="text-gold hover:text-gold-dark mb-8 inline-block transition-colors"
        >
          ← Retour aux robes
        </a>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start">
          <div class="space-y-4">
            <div class="aspect-[3/4] overflow-hidden rounded-lg">
              <img
                src={robe.images?.[0] ||
                  `https://images.unsplash.com/photo-1515377905703-c4788e51af15?w=1200&q=80`}
                alt={robe.name}
                class="w-full h-full object-cover"
              />
            </div>
            {
              robe.images && robe.images.length > 1 && (
                <div class="grid grid-cols-3 gap-4">
                  {robe.images.slice(1).map((image, index) => (
                    <div class="aspect-square overflow-hidden rounded-lg">
                      <img
                        src={image}
                        alt={`${robe.name} - Vue ${index + 2}`}
                        class="w-full h-full object-cover cursor-pointer hover:opacity-80 transition-opacity"
                      />
                    </div>
                  ))}
                </div>
              )
            }
          </div>

          <div>
            <span
              class="text-xs uppercase tracking-[0.2em] text-gold font-semibold mb-4 inline-block"
            >
              {robe.collection}
            </span>
            <h1 class="text-4xl md:text-5xl mb-6">{robe.name}</h1>
            <p class="text-xl text-gray-dark mb-8 leading-relaxed">
              {robe.description}
            </p>

            {
              robe.price && (
                <div class="mb-8">
                  <p class="text-2xl font-serif text-gold mb-2">{robe.price}</p>
                  <p class="text-sm text-gray-dark">
                    Location pour votre jour J
                  </p>
                </div>
              )
            }

            {
              robe.details && robe.details.length > 0 && (
                <div class="mb-8">
                  <h3 class="text-xl font-serif mb-4">Caractéristiques</h3>
                  <ul class="space-y-2">
                    {robe.details.map((detail) => (
                      <li class="flex items-start gap-3 text-gray-dark">
                        <span class="text-gold mt-1">•</span>
                        <span>{detail}</span>
                      </li>
                    ))}
                  </ul>
                </div>
              )
            }

            <div class="flex flex-col gap-4">
              <a
                href="https://calendly.com/linaya-mariage"
                target="_blank"
                rel="noopener"
                class="btn btn-gold btn-large text-center"
              >
                Prendre rendez-vous pour essayer
              </a>
              <a href="/contact" class="btn btn-primary text-center">
                Nous contacter
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <Footer />
</BaseLayout>
